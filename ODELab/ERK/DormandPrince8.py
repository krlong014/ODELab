from . ERKStepper import ERKStepper
import numpy as np

class DormandPrince8(ERKStepper):

    def __init__(self, **kwargs):

        c = (0,0.05260015195876773,0.07890022793815160,0.1183503419072274,
             0.2816496580927726,0.3333333333333333,0.2500000000000000,
             0.3076923076923077,0.6512820512820513,0.6000000000000000,
             0.8571428571428571,1.000000000000000)
        b = (0.05429373411656876,0,0,0,0,4.450312892752409,
             1.891517899314500,-5.801203960010585,0.3111643669578199,
             -0.1521609496625161,0.2013654008040303,0.04471061572777259)
        AMap={
        	(2, 1)  : 0.052600151958767731878558754448802,
        	(3, 1)  : 0.01972505698453789945445953291830,
        	(3, 2)  : 0.0591751709536136983633785987549,
        	(4, 1)  : 0.02958758547680684918168929937745,
        	(4, 3)  : 0.0887627564304205475450678981324,
        	(5, 1)  : 0.24136513415926668550236979866451,
        	(5, 3)  : -0.88454947932828608534486496271706,
        	(5, 4)  : 0.92483400326179200311573796654275,
        	(6, 1)  : 0.037037037037037037037037037037037,
        	(6, 4)  : 0.17082860872947387127960448217320,
        	(6, 5)  : 0.12546768756682242501669181412309,
        	(7, 1)  : 0.037109375000000000000000000000000,
        	(7, 4)  : 0.17025221101954403931497806027171,
        	(7, 5)  : 0.060216538980455960685021939728286,
        	(7, 6)  : -0.017578125000000000000000000000000,
        	(8, 1)  : 0.037092000118504792710877931983636,
        	(8, 4)  : 0.17038392571223999381021405470449,
        	(8, 5)  : 0.10726203044637328465180919916779,
        	(8, 6)  : -0.015319437748624401752793615823622,
        	(8, 7)  : 0.0082737891638140228875847376600151,
        	(9, 1)  : 0.62411095871607571711442957781205,
        	(9, 4)  : -3.3608926294469412940685710982460,
        	(9, 5)  : -0.86821934684172600681818989145257,
        	(9, 6)  : 27.592099699446708304941560079685,
        	(9, 7)  : 20.154067550477893408618678897886,
        	(9, 8)  : -43.489884181069958847736625514403,
        	(10, 1)  : 0.47766253643826436589043390852739,
        	(10, 4)  : -2.4881146199716676419264258646824,
        	(10, 5)  : -0.59029082683684299637144647574314,
        	(10, 6)  : 21.230051448181194234728894989705,
        	(10, 7)  : 15.279233632882423583259692293748,
        	(10, 8)  : -33.288210968984862919445326558696,
        	(10, 9)  : -0.020331201708508626135822292859293,
        	(11, 1)  : -0.93714243008598732571704021658042,
        	(11, 4)  : 5.1863724288440637083002385320895,
        	(11, 5)  : 1.0914373489967295781850025465390,
        	(11, 6)  : -8.1497870107469261251399726735691,
        	(11, 7)  : -18.520065659996959864156618070115,
        	(11, 8)  : 22.739487099350504281897005673360,
        	(11, 9)  : 2.4936055526796523898708939676189,
        	(11, 10)  : -3.0467644718982195003823669022001,
        	(12, 1)  : 2.2733101475165382079235976844939,
        	(12, 4)  : -10.534495466737250198406668987893,
        	(12, 5)  : -2.0008720582248624990967571844382,
        	(12, 6)  : -17.958931863118798917276595053362,
        	(12, 7)  : 27.948884529419960050849980883716,
        	(12, 8)  : -2.8589982771350236947406550867357,
        	(12, 9)  : -8.8728569335306295443354928925846,
        	(12, 10)  : 12.360567175794303064726620152757,
        	(12, 11)  : 0.64339274601576353035597048404607
        }

        A = np.zeros((12,12))
        for k,v in AMap.items():
            A[k[0]-1,k[1]-1] = v

        p = 8

        super().__init__(A, b, c, p)
